(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(2939)}])},2939:function(e,t,n){"use strict";let r;n.r(t),n.d(t,{default:function(){return T}});var a=n(5893),s=n(7294),o=n(1163),l=n(6154),i=n(9367),u=n(1142),c=n.n(u),p=JSON.parse('{"P_":"https://slide.diginori.com/hello-reflex/upload","Om":"wss://slide.diginori.com/hello-reflex/event","H5":"https://slide.diginori.com/hello-reflex/ping"}'),x=n(5885);p.H5;let d=p.Om,f=p.P_,g="token",m=new x.Z,h={},_=()=>{let e=new Date().getTime(),t=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,n=>{let r=16*Math.random();return e>0?(r=(e+r)%16|0,e=Math.floor(e/16)):(r=(t+r)%16|0,t=Math.floor(t/16)),("x"==n?r:7&r|8).toString(16)})},y=()=>(r||window&&(window.sessionStorage.getItem(g)||window.sessionStorage.setItem(g,_()),r=window.sessionStorage.getItem(g)),r),v=(e,t)=>{for(let n in t){let r=e,a=n.split(".").slice(1);for(;a.length>0;)r=r[a.shift()];for(let e in t[n])r[e]=t[n][e]}},w=async(e,t,n)=>{if("_redirect"==e.name)return t.push(e.payload.path),!1;if("_console"==e.name)return console.log(e.payload.message),!1;if("_set_cookie"==e.name)return m.set(e.payload.key,e.payload.value),!1;if("_remove_cookie"==e.name)return m.remove(e.payload.key,e.payload.options),!1;if("_set_local_storage"==e.name)return localStorage.setItem(e.payload.key,e.payload.value),!1;if("_clear_local_storage"==e.name)return localStorage.clear(),!1;if("_remove_local_storage"==e.name)return localStorage.removeItem(e.payload.key),!1;if("_set_clipboard"==e.name){let t=e.payload.content;return navigator.clipboard.writeText(t),!1}if("_alert"==e.name)return alert(e.payload.message),!1;if("_set_focus"==e.name){let t=e.payload.ref in h?h[e.payload.ref]:e.payload.ref;return t.current.focus(),!1}if("_set_value"==e.name){let t=e.payload.ref in h?h[e.payload.ref]:e.payload.ref;return t.current.value=e.payload.value,!1}return e.token=y(),e.router_data=(e=>{let{pathname:t,query:n,asPath:r}=e;return{pathname:t,query:n,asPath:r}})(t),!!n&&(n.emit("event",JSON.stringify(e)),!0)},b=async(e,t,n)=>{let r=!1;return"uploadFiles"==e.handler&&(r=await S(t,n,e.name)),r},j=async(e,t,n,r,a,s)=>{if(n.processing||0==e.events.length)return;r({...n,processing:!0});let o=e.events.shift();t(t=>({...t,events:e.events}));(o.handler?await b(o,e,r):await w(o,a,s))||r({...n,final:!0,processing:!1})},k=async(e,t,n,r,a,s,o,l)=>{let u=new URL(d);e.current=(0,i.ZP)(d,{path:u.pathname,transports:o,autoUnref:!1}),e.current.on("connect",()=>{j(t,n,r,a,s,e.current),l(!1)}),e.current.on("connect_error",e=>{l(!0)}),e.current.on("event",e=>{v(t,(e=c().parse(e)).delta),a(n=>({state:t,events:[...n.events,...e.events],final:e.final,processing:!0}))})},S=async(e,t,n)=>{let r=e.files;if(0==r.length)return!1;let a={"Content-Type":r[0].type},s=new FormData;for(let e=0;e<r.length;e++)s.append("files",r[e],y()+":"+n+":"+r[e].name);await l.Z.post(f,s,a).then(()=>!0).catch(e=>(e.response?console.log(e.response.data):e.request?console.log(e.request):console.log(e.message),!1))},E=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return{name:e,payload:t,handler:n}},F=e=>{e&&"submit"==e.type&&e.preventDefault()};n(5202);var R=n(2498),C=n(6979),q=n(3100),A=n(9564),I=n(4085),N=n(1686),O=n(9222),D=n(9008),P=n.n(D);function T(){let[e,t]=(0,s.useState)({chat_history:[],is_hydrated:!1,question:"",events:[{name:"state.hydrate"}],files:[]}),[n,r]=(0,s.useState)({state:null,events:[],final:!0,processing:!1}),[l,i]=(0,s.useState)(!1),u=(0,o.useRouter)(),c=(0,s.useRef)(null),{isReady:p}=u,{colorMode:x,toggleColorMode:d}=(0,R.If)(),f=(0,s.useRef)(),g=(e,n)=>{F(n),t(t=>({...t,events:[...t.events,...e]}))};(0,s.useEffect)(()=>{p&&(c.current||k(c,e,t,n,r,u,["websocket","polling"],i),n.processing||j(e,t,n,r,u,c.current),r(e=>null!=e.state?(t(t=>({...e.state,events:[...t.events,...e.events]})),{state:null,events:[],final:!0,processing:!e.final}):e),j(e,t,n,r,u,c.current))}),(0,s.useEffect)(()=>{f.current&&f.current.focus()}),(0,s.useEffect)(()=>{let e=()=>g([E("state.hydrate",{})]);return u.events.on("routeChangeComplete",e),()=>{u.events.off("routeChangeComplete",e)}},[u]);let m=(0,s.useRef)(null);return h.ref_question=m,(0,a.jsx)(s.Fragment,{children:(0,a.jsxs)(s.Fragment,{children:[(0,a.jsxs)(C.W,{children:[(0,a.jsx)(q.xu,{children:e.chat_history.map((e,t)=>(0,a.jsxs)(q.xu,{sx:{marginY:"1em"},children:[(0,a.jsx)(q.xu,{sx:{padding:"1em",borderRadius:"5px",marginY:"0.5em",boxShadow:"rgba(0, 0, 0, 0.15) 0px 2px 8px",bg:"#F5EFFE",marginLeft:"20%"},children:(0,a.jsx)(A.x,{sx:{textAlign:"right"},children:e.at(0)})}),(0,a.jsx)(q.xu,{sx:{padding:"1em",borderRadius:"5px",marginY:"0.5em",boxShadow:"rgba(0, 0, 0, 0.15) 0px 2px 8px",bg:"#DEEAFD",marginRight:"20%"},children:(0,a.jsx)(A.x,{sx:{textAlign:"left"},children:e.at(1)})})]},t))}),(0,a.jsxs)(I.U,{children:[(0,a.jsx)(N.I,{id:"question",onBlur:e=>g([E("state.set_question",{value:e.target.value})],e),placeholder:"Ask a question",ref:m,sx:{borderWidth:"1px",padding:"1em",boxShadow:"rgba(0, 0, 0, 0.15) 0px 2px 8px"},type:"text"}),(0,a.jsx)(O.z,{onClick:e=>g([E("state.answer",{})],e),sx:{bg:"#CEFFEE",boxShadow:"rgba(0, 0, 0, 0.15) 0px 2px 8px"},children:"Ask"})]})]}),(0,a.jsxs)(P(),{children:[(0,a.jsx)("title",{children:"Reflex App"}),(0,a.jsx)("meta",{content:"A Reflex app.",name:"description"}),(0,a.jsx)("meta",{content:"favicon.ico",property:"og:image"})]})]})})}}},function(e){e.O(0,[259,774,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);